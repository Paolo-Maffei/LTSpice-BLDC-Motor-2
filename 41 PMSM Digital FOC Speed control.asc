Version 4
SHEET 1 4500 1892
WIRE -2176 -1296 -2624 -1296
WIRE -2624 -1248 -2624 -1296
WIRE -2880 -1184 -2912 -1184
WIRE -2704 -1184 -2736 -1184
WIRE -2512 -1184 -2560 -1184
WIRE -2368 -1184 -2512 -1184
WIRE -2176 -1184 -2176 -1296
WIRE -2176 -1184 -2208 -1184
WIRE -2368 -1152 -2400 -1152
WIRE -3360 -1136 -3712 -1136
WIRE -3024 -1136 -3072 -1136
WIRE -2768 -1120 -2768 -1152
WIRE -2768 -1120 -2848 -1120
WIRE -2768 -1104 -2768 -1120
WIRE -3360 -1088 -3728 -1088
WIRE -704 -1024 -784 -1024
WIRE -496 -1024 -544 -1024
WIRE -192 -1024 -272 -1024
WIRE 16 -1024 -32 -1024
WIRE 288 -1024 192 -1024
WIRE 576 -1024 448 -1024
WIRE -496 -992 -544 -992
WIRE 16 -992 -32 -992
WIRE 192 -992 192 -1024
WIRE 576 -992 448 -992
WIRE -704 -960 -784 -960
WIRE -496 -960 -544 -960
WIRE -192 -960 -272 -960
WIRE 16 -960 -32 -960
WIRE 288 -960 240 -960
WIRE 576 -960 448 -960
WIRE -2912 -896 -2912 -1184
WIRE -2848 -896 -2912 -896
WIRE -704 -896 -752 -896
WIRE -192 -896 -240 -896
WIRE 288 -896 192 -896
WIRE -752 -848 -752 -896
WIRE -752 -848 -864 -848
WIRE -240 -848 -240 -896
WIRE -240 -848 -752 -848
WIRE 192 -848 192 -896
WIRE 192 -848 -240 -848
WIRE -3216 -800 -3408 -800
WIRE -3024 -800 -3024 -1136
WIRE -3024 -800 -3216 -800
WIRE -3408 -720 -3408 -800
WIRE -2512 -720 -2512 -1184
WIRE -3488 -656 -3776 -656
WIRE -3248 -656 -3344 -656
WIRE -2912 -656 -2912 -896
WIRE -2912 -656 -2960 -656
WIRE -2880 -656 -2912 -656
WIRE -2592 -656 -2736 -656
WIRE -2416 -656 -2448 -656
WIRE -2192 -656 -2256 -656
WIRE -1600 -656 -1904 -656
WIRE -32 -656 -416 -656
WIRE 272 -656 -32 -656
WIRE 640 -656 272 -656
WIRE 1424 -640 1360 -640
WIRE 1360 -624 1360 -640
WIRE -3248 -608 -3312 -608
WIRE -2192 -608 -2208 -608
WIRE -416 -608 -416 -656
WIRE 1088 -608 896 -608
WIRE 1312 -608 1232 -608
WIRE 1424 -608 1424 -640
WIRE 1456 -608 1424 -608
WIRE 1632 -608 1600 -608
WIRE 2240 -608 1632 -608
WIRE -2768 -592 -2768 -624
WIRE -2768 -592 -2848 -592
WIRE -3776 -576 -3776 -656
WIRE -2768 -576 -2768 -592
WIRE 1312 -560 1296 -560
WIRE -2208 -544 -2208 -608
WIRE -32 -528 -32 -656
WIRE 1296 -528 1296 -560
WIRE 1360 -528 1360 -544
WIRE 1360 -528 1296 -528
WIRE -416 -512 -416 -528
WIRE 1360 -496 1360 -528
WIRE 1536 -496 1536 -544
WIRE -3312 -464 -3312 -608
WIRE -992 -464 -1040 -464
WIRE -720 -464 -992 -464
WIRE -544 -464 -576 -464
WIRE -368 -464 -400 -464
WIRE -208 -464 -224 -464
WIRE -112 -464 -208 -464
WIRE 80 -464 32 -464
WIRE 640 -464 224 -464
WIRE -3776 -448 -3776 -496
WIRE 1168 -432 1168 -544
WIRE 1232 -432 1168 -432
WIRE 1632 -432 1632 -608
WIRE 1680 -432 1632 -432
WIRE 1872 -432 1824 -432
WIRE 1920 -432 1872 -432
WIRE 2240 -432 2064 -432
WIRE -208 -416 -208 -464
WIRE -64 -416 -208 -416
WIRE 192 -400 192 -432
WIRE 192 -400 112 -400
WIRE -208 -384 -208 -416
WIRE 192 -384 192 -400
WIRE -640 -368 -640 -400
WIRE -640 -368 -768 -368
WIRE -288 -368 -288 -400
WIRE -288 -368 -320 -368
WIRE 1792 -368 1792 -400
WIRE 1792 -368 1712 -368
WIRE -768 -336 -768 -368
WIRE -640 -336 -640 -368
WIRE 1712 -336 1712 -368
WIRE 2000 -336 2000 -368
WIRE -464 -320 -464 -400
WIRE -304 -320 -336 -320
WIRE -272 -320 -304 -320
WIRE -112 -320 -128 -320
WIRE -1600 -288 -1600 -656
WIRE -1408 -288 -1600 -288
WIRE -1216 -288 -1248 -288
WIRE -1040 -288 -1040 -464
WIRE -1040 -288 -1056 -288
WIRE -304 -256 -304 -320
WIRE 640 -256 -304 -256
WIRE -1408 -224 -1808 -224
WIRE -1216 -224 -1248 -224
WIRE -1040 -224 -1056 -224
WIRE -768 -208 -768 -256
WIRE -768 -208 -864 -208
WIRE -640 -208 -640 -256
WIRE -640 -208 -768 -208
WIRE -112 -208 -112 -320
WIRE 48 -208 -112 -208
WIRE -864 -176 -864 -208
WIRE 1168 -160 1168 -432
WIRE -4096 -144 -5024 -144
WIRE -768 -144 -768 -208
WIRE -640 -144 -640 -208
WIRE 272 -144 272 -656
WIRE 1872 -144 1872 -432
WIRE 2256 -144 1872 -144
WIRE -1664 -96 -1744 -96
WIRE -1328 -96 -1328 -160
WIRE -1328 -96 -1376 -96
WIRE -464 -96 -336 -320
WIRE -336 -96 -464 -320
WIRE -272 -96 -336 -96
WIRE -112 -96 -112 -208
WIRE -112 -96 -128 -96
WIRE 192 -80 176 -80
WIRE 368 -80 336 -80
WIRE 672 -80 512 -80
WIRE 896 -80 896 -608
WIRE 896 -80 672 -80
WIRE -5024 -64 -5024 -144
WIRE -4976 -64 -5024 -64
WIRE -4592 -64 -4832 -64
WIRE -1664 -48 -1680 -48
WIRE 1168 -32 1168 -80
WIRE -768 -16 -768 -64
WIRE -640 -16 -640 -64
WIRE -640 -16 -768 -16
WIRE 480 -16 480 -48
WIRE 480 -16 400 -16
WIRE -4160 0 -4768 0
WIRE -2176 0 -2624 0
WIRE -208 0 -208 -32
WIRE -80 0 -208 0
WIRE 480 0 480 -16
WIRE -1680 16 -1680 -48
WIRE -1136 16 -1136 -160
WIRE -1136 16 -1264 16
WIRE -640 16 -640 -16
WIRE -464 16 -464 -96
WIRE 1632 16 1632 -432
WIRE 1680 16 1632 16
WIRE 2256 16 1824 16
WIRE -2624 48 -2624 0
WIRE -4592 64 -4592 -64
WIRE -4768 80 -4768 0
WIRE -1040 80 -1040 -224
WIRE -992 80 -1040 80
WIRE -720 80 -992 80
WIRE -544 80 -576 80
WIRE -368 80 -400 80
WIRE -208 80 -208 0
WIRE -208 80 -224 80
WIRE -176 80 -208 80
WIRE 176 80 176 -80
WIRE 176 80 -32 80
WIRE 640 80 176 80
WIRE 1792 80 1792 48
WIRE 1792 80 1712 80
WIRE -2880 112 -2912 112
WIRE -2704 112 -2736 112
WIRE -2512 112 -2560 112
WIRE -2368 112 -2512 112
WIRE -2176 112 -2176 0
WIRE -2176 112 -2208 112
WIRE 1712 112 1712 80
WIRE -5200 144 -5280 144
WIRE -4848 144 -5056 144
WIRE -4672 144 -4704 144
WIRE -4480 144 -4512 144
WIRE -4384 144 -4480 144
WIRE -4160 144 -4160 0
WIRE -4160 144 -4224 144
WIRE -2368 144 -2400 144
WIRE -64 144 -64 112
WIRE -64 144 -144 144
WIRE -3360 160 -3696 160
WIRE -3024 160 -3072 160
WIRE -64 160 -64 144
WIRE -4384 176 -4416 176
WIRE -2768 176 -2768 144
WIRE -2768 176 -2848 176
WIRE -288 176 -288 144
WIRE -2768 192 -2768 176
WIRE -1744 192 -1744 -96
WIRE -1328 192 -1744 192
WIRE -5088 208 -5088 176
WIRE -5088 208 -5168 208
WIRE -3360 208 -3712 208
WIRE -5088 224 -5088 208
WIRE -4416 256 -4416 176
WIRE -4384 256 -4416 256
WIRE 48 256 48 -208
WIRE 48 256 -976 256
WIRE -1664 288 -1696 288
WIRE -1328 288 -1328 192
WIRE -1328 288 -1376 288
WIRE -4848 336 -4960 336
WIRE -4592 336 -4592 224
WIRE -4592 336 -4704 336
WIRE -1664 336 -1680 336
WIRE -4096 368 -4096 -144
WIRE -4096 368 -4208 368
WIRE -5280 400 -5280 144
WIRE -5232 400 -5280 400
WIRE -2912 400 -2912 112
WIRE -2848 400 -2912 400
WIRE -4208 432 -4208 368
WIRE -4896 464 -4896 0
WIRE -4768 464 -4768 400
WIRE -4768 464 -4896 464
WIRE -1680 480 -1680 336
WIRE -3216 496 -3408 496
WIRE -3024 496 -3024 160
WIRE -3024 496 -3216 496
WIRE -4096 560 -4096 368
WIRE -4480 576 -4480 144
WIRE -4208 576 -4208 512
WIRE -3408 576 -3408 496
WIRE -2512 576 -2512 112
WIRE -736 608 -784 608
WIRE 224 608 176 608
WIRE 960 608 912 608
WIRE 1904 608 1856 608
WIRE -5936 640 -6064 640
WIRE -5808 640 -5936 640
WIRE -5616 640 -5664 640
WIRE -5280 640 -5280 400
WIRE -5280 640 -5328 640
WIRE -5200 640 -5280 640
WIRE -4896 640 -4896 464
WIRE -4896 640 -5056 640
WIRE -4560 640 -4896 640
WIRE -4176 640 -4416 640
WIRE -3776 640 -4016 640
WIRE -3488 640 -3776 640
WIRE -3248 640 -3344 640
WIRE -2912 640 -2912 400
WIRE -2912 640 -2960 640
WIRE -2880 640 -2912 640
WIRE -2592 640 -2736 640
WIRE -2416 640 -2448 640
WIRE -2192 640 -2256 640
WIRE -1808 640 -1808 -224
WIRE -1808 640 -1904 640
WIRE -6064 688 -6064 640
WIRE -5616 688 -5648 688
WIRE -3248 688 -3312 688
WIRE -2192 688 -2208 688
WIRE -5088 704 -5088 672
WIRE -5088 704 -5168 704
WIRE -2768 704 -2768 672
WIRE -2768 704 -2848 704
WIRE 912 704 912 608
WIRE 1856 704 1856 608
WIRE -5088 720 -5088 704
WIRE -2768 720 -2768 704
WIRE -784 720 -784 608
WIRE 176 720 176 608
WIRE -5648 752 -5648 688
WIRE -5616 752 -5648 752
WIRE -3312 768 -3312 688
WIRE -2208 768 -2208 688
WIRE -4960 784 -4960 336
WIRE -4096 784 -4096 720
WIRE -4096 784 -4960 784
WIRE -6064 816 -6064 768
WIRE 912 816 912 784
WIRE 1856 816 1856 784
WIRE -4096 832 -4096 784
WIRE -784 832 -784 800
WIRE 176 832 176 800
WIRE -5728 912 -5728 704
WIRE -5728 912 -6000 912
WIRE -4096 976 -4096 912
FLAG -976 256 Wd
FLAG 2240 -608 Wmech
FLAG 2256 -144 Wd
FLAG 2000 -336 0
FLAG 2240 -432 Theta_d
FLAG 1232 -432 Load_Torque
FLAG 1536 -496 0
FLAG 1360 -496 0
FLAG 1168 -32 0
FLAG -2768 -1104 0
FLAG -2768 -576 0
FLAG 912 816 0
FLAG 960 608 Sample
FLAG -3712 -1136 Isd
FLAG -2400 -1152 Sample
FLAG 176 832 0
FLAG -2848 -896 Isd_Error
FLAG -3216 -800 sampled_Isd
FLAG -2768 192 0
FLAG -2768 720 0
FLAG -3696 160 Isq
FLAG -2400 144 Sample
FLAG 1856 816 0
FLAG -2848 400 Isq_Error
FLAG -3216 496 sampled_Isq
FLAG -3776 -448 0
FLAG 224 608 ADC_Trigger
FLAG -3728 -1088 ADC_Trigger
FLAG -3712 208 ADC_Trigger
FLAG -3312 -464 Sample
FLAG -3312 768 Sample
FLAG 1904 608 PWM_Reload
FLAG -2208 768 PWM_Reload
FLAG -2208 -544 PWM_Reload
FLAG -992 -464 Vsd
FLAG -992 80 Vsq
FLAG -6064 816 0
FLAG -6000 912 Wmech_RPM
FLAG -4208 576 0
FLAG -4096 976 0
FLAG -5088 224 0
FLAG -5088 720 0
FLAG -5936 640 Speed_command
FLAG -5232 400 Speed_Error
FLAG -3776 640 Isq_command
FLAG -784 832 0
FLAG -736 608 Speed_Trigger
FLAG -5616 752 Speed_Trigger
FLAG -4384 256 Speed_Trigger
FLAG -864 -848 Theta_d
FLAG -784 -1024 Vsd
FLAG -784 -960 Vsq
FLAG -272 -1024 Isd
FLAG -272 -960 Isq
FLAG -496 -1024 Va
FLAG -496 -992 Vb
FLAG -496 -960 Vc
FLAG 16 -1024 Ia
FLAG 16 -992 Ib
FLAG 16 -960 Ic
FLAG 192 -992 0
FLAG 240 -960 EMF
FLAG 576 -1024 EMFa
FLAG 576 -992 EMFb
FLAG 576 -960 EMFc
FLAG 1712 112 0
FLAG 2256 16 Wmech_RPM
FLAG 640 80 Isq
FLAG -64 -416 Flux_sd
FLAG -80 0 Flux_sq
FLAG -288 176 0
FLAG 640 -464 Isd
FLAG 672 -80 Tem
FLAG -864 -176 0
FLAG 640 -656 Flux_fd
FLAG -416 -512 0
FLAG -320 -368 Flux_fd
FLAG 640 -256 EMF
FLAG -64 160 0
FLAG 480 0 0
FLAG 192 -384 0
FLAG 1712 -336 0
FLAG -1680 16 PWM_Reload
FLAG -1696 288 Theta_d
FLAG -1264 16 Theta_d
FLAG -1680 480 Sample
SYMBOL Integrator 2000 -432 R0
SYMATTR InstName X26
SYMBOL Subtractor 1168 -608 R0
SYMATTR InstName X27
SYMBOL Integrator 1536 -608 R0
SYMATTR InstName X29
SYMBOL e 1360 -640 R0
SYMATTR InstName E9
SYMATTR Value {1/Jeq}
SYMBOL Subtractor -3408 -656 M180
SYMATTR InstName X17
SYMBOL Adder -2512 -656 M180
SYMATTR InstName X18
SYMBOL Gain -2832 -1216 R0
WINDOW 3 -60 -46 Left 2
SYMATTR Value {Id/Fs}
SYMATTR InstName E13
SYMBOL Gain -2832 -688 R0
WINDOW 3 -34 -45 Left 2
SYMATTR Value {Pd}
SYMATTR InstName E15
SYMBOL voltage 912 688 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -61 189 Left 2
SYMATTR Value PULSE(-1 1 0 0 0 {T_aperture} {1/Fs} 100000)
SYMATTR InstName V3
SYMBOL Delay -2288 -1184 R0
SYMATTR InstName X23
SYMBOL Adder -2624 -1184 M180
SYMATTR InstName X24
SYMBOL S&H -3104 -656 R0
SYMATTR InstName X25
SYMBOL S&H -2048 -656 R0
SYMATTR InstName X28
SYMBOL S&H -3216 -1136 R0
SYMATTR InstName X30
SYMBOL voltage 176 704 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -227 183 Left 2
SYMATTR Value PULSE(-1 1 {20uS + p/2 - T_aperture} 0 0 {T_aperture} {p} 100000)
SYMATTR InstName V6
SYMBOL Subtractor -3408 640 M180
SYMATTR InstName X31
SYMBOL Adder -2512 640 M180
SYMATTR InstName X32
SYMBOL Gain -2832 80 R0
WINDOW 3 -60 -46 Left 2
SYMATTR Value {Iq/Fs}
SYMATTR InstName E16
SYMBOL Gain -2832 608 R0
WINDOW 3 -34 -45 Left 2
SYMATTR Value {Pq}
SYMATTR InstName E17
SYMBOL Delay -2288 112 R0
SYMATTR InstName X34
SYMBOL Adder -2624 112 M180
SYMATTR InstName X35
SYMBOL S&H -3104 640 R0
SYMATTR InstName X36
SYMBOL S&H -2048 640 R0
SYMATTR InstName X37
SYMBOL voltage 1856 688 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -323 187 Left 2
SYMATTR Value PULSE(-1 1 {20uS + p*2 - T_aperture/2} 0 0 {T_aperture} {p*2} 100000)
SYMATTR InstName V12
SYMBOL S&H -3216 160 R0
SYMATTR InstName X38
SYMBOL voltage -3776 -592 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 35 82 Left 2
SYMATTR Value 0
SYMATTR InstName V15
SYMBOL Subtractor -5728 640 R0
SYMATTR InstName X1
SYMBOL voltage -6064 672 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -69 189 Left 2
SYMATTR Value PWL(0 0 0.01999999 0 0.02 3000 0.199999 3000 0.2 -3000)
SYMATTR InstName V2
SYMBOL voltage -4208 416 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -123 99 Left 2
SYMATTR Value {I_limit}
SYMATTR InstName V4
SYMBOL voltage -4096 816 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value {-I_limit}
SYMBOL Clamp -4096 640 R0
SYMATTR InstName X2
SYMBOL Adder -4480 640 M180
SYMATTR InstName X11
SYMBOL Gain -5152 112 R0
WINDOW 3 -74 -46 Left 2
SYMATTR Value {I_speed/Fs_speed}
SYMATTR InstName E1
SYMBOL Gain -5152 608 R0
WINDOW 3 -36 -57 Left 2
SYMATTR Value {P_speed}
SYMATTR InstName E5
SYMBOL Subtractor -4896 -64 R0
SYMATTR InstName X12
SYMBOL Subtractor -4768 336 R0
SYMATTR InstName X14
SYMBOL Delay -4304 144 R0
SYMATTR InstName X15
SYMBOL Adder -4768 144 M180
SYMATTR InstName X19
SYMBOL S&H -5472 640 R0
SYMATTR InstName X20
SYMBOL Clamp -4592 144 R0
SYMATTR InstName X39
SYMBOL voltage -784 704 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 -227 183 Left 2
SYMATTR Value PULSE(-1 1 {20uS + 3*p/2 - T_aperture} 0 0 {T_aperture} {1/Fs_speed} 100000)
SYMATTR InstName V8
SYMBOL DQ-ABC -624 -992 R0
SYMATTR InstName X40
SYMBOL DQ-ABC -112 -992 R0
SYMATTR InstName X41
SYMBOL voltage 1168 -176 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V7
SYMATTR Value 2
SYMBOL DQ-ABC 368 -992 R0
SYMATTR InstName X42
SYMBOL Gain 1728 -16 R0
WINDOW 3 -25 31 Left 2
SYMATTR Value {30/pi}
SYMATTR InstName E7
SYMBOL Clamp1 -2336 -656 R0
WINDOW 39 -624 143 Left 2
SYMATTR SpiceLine max={bus_voltage}/(2*sqrt(2/3)), min={-bus_voltage}/(2*sqrt(2/3))
SYMATTR InstName X43
SYMBOL Clamp1 -2336 640 R0
WINDOW 39 -624 143 Left 2
SYMATTR SpiceLine max={bus_voltage}/(2*sqrt(2/3)), min={-bus_voltage}/(2*sqrt(2/3))
SYMATTR InstName X21
SYMBOL Subtractor -640 -464 R0
SYMATTR InstName X3
SYMBOL Integrator -288 -464 R0
SYMATTR InstName X4
SYMBOL Multiplier -208 -320 R180
SYMATTR InstName X5
SYMBOL Adder -464 -464 R0
SYMATTR InstName X6
SYMBOL Integrator -288 80 R0
SYMATTR InstName X7
SYMBOL Multiplier -208 -96 M0
SYMATTR InstName X8
SYMBOL Subtractor -640 80 M180
SYMATTR InstName X9
SYMBOL Subtractor -464 80 M180
SYMATTR InstName X10
SYMBOL Subtractor -32 -464 M180
SYMATTR InstName X13
SYMBOL Multiplier 272 -80 M180
SYMATTR InstName X16
SYMBOL bi2 -768 -336 R0
SYMATTR InstName B1
SYMATTR Value I=V(Isd)
SYMBOL res -656 -352 R0
SYMATTR InstName R1
SYMATTR Value {Rs}
SYMBOL bi -768 -144 R0
SYMATTR InstName B2
SYMATTR Value I=V(Isq)
SYMBOL res -656 -160 R0
SYMATTR InstName R2
SYMATTR Value {Rs}
SYMBOL voltage -416 -624 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value {Ke}
SYMBOL Gain -128 48 R0
WINDOW 3 -24 34 Left 2
SYMATTR Value {1/Ls}
SYMATTR InstName E2
SYMBOL Gain 416 -112 R0
WINDOW 3 -37 -41 Left 2
SYMATTR Value {3*poles/4}
SYMATTR InstName E4
SYMBOL Gain 128 -496 R0
WINDOW 3 -24 34 Left 2
SYMATTR Value {1/Ls}
SYMATTR InstName E8
SYMBOL Gain 1728 -464 R0
WINDOW 3 -25 31 Left 2
SYMATTR Value {poles/2}
SYMATTR InstName E10
SYMBOL Rev_Park -1328 -256 R0
SYMATTR InstName X22
SYMBOL S&H -1520 -96 R0
SYMATTR InstName X45
SYMBOL Fwd_Park -1136 -256 R0
SYMATTR InstName X46
SYMBOL S&H -1520 288 R0
SYMATTR InstName X47
TEXT -5168 -1344 Left 2 !.tran 0.4 uic
TEXT -5168 -1384 Left 2 ;PERMANENT MAGNET AC MOTOR MODEL WITH CURRENT MODE CONTROL
TEXT 1272 -728 Left 2 !.param Jeq=2E-3
TEXT -5176 -1000 Left 2 !.param Ke=0.0957
TEXT -5176 -1120 Left 2 !.param poles=4
TEXT -5176 -1096 Left 2 !.param Rs=0.416
TEXT -5176 -1064 Left 2 !.param Lm=368.7E-3
TEXT -5176 -1032 Left 2 !.param Ls=1.365E-3
TEXT -5176 -800 Left 2 !.param Id=2000
TEXT -5176 -832 Left 2 !.param Pd=5
TEXT -5176 -768 Left 2 !.param Pq=5
TEXT -5176 -736 Left 2 !.param Iq=2000
TEXT 784 -744 Left 2 ;LOAD
TEXT -5176 -1152 Left 2 !.param bus_voltage = 230 * sqrt(2)
TEXT -3488 -1432 Left 2 ;CURRENT REGULATOR
TEXT -3256 -1208 Left 2 ;ADC
TEXT 240 768 Left 2 ;ADC Trigger
TEXT -2152 -728 Left 2 ;PWM Module Reload
TEXT -2936 -1368 Left 2 ;INTEGRATOR
TEXT -3488 -136 Left 2 ;CURRENT REGULATOR
TEXT -3256 88 Left 2 ;ADC
TEXT -3360 296 Left 2 ;ADC Trigger
TEXT -2152 568 Left 2 ;PWM Module Reload
TEXT -2936 -72 Left 2 ;INTEGRATOR
TEXT -5184 -608 Left 2 !.param T_aperture = 0.25E-6
TEXT -5184 -672 Left 2 !.param Fs = 10E3
TEXT -5184 -520 Left 2 !.model VCS SW(Ron=0.00001 Roff=1T Vt=0)
TEXT -5184 -576 Left 2 !.param p = 50uS
TEXT -5816 -144 Left 2 ;SPEED REGULATOR
TEXT -5992 664 Left 2 ;RPM
TEXT -5184 -640 Left 2 !.param Fs_speed=5E3
TEXT -5176 -960 Left 2 !.param I_limit=30
TEXT -5176 -864 Left 2 !.param I_speed=300
TEXT -5176 -896 Left 2 !.param P_speed=0.8
TEXT 968 744 Left 2 ;Current Loop
TEXT -728 760 Left 2 ;Speed Loop
TEXT -5168 -1312 Left 2 !.options method = gear
TEXT -904 -728 Left 2 ;MOTOR
TEXT -1632 -168 Left 2 ;PWM Module Reload
TEXT -5848 1128 Left 2 ;D A V E    W I L S O N\nK A P P A   E L E C T R O N I C S   L L C\ndave@kappaiq.com\nwww.kappaiq.com
LINE Normal -2336 -592 -2368 -528
LINE Normal -2336 704 -2368 768
RECTANGLE Normal 2192 400 752 -768
RECTANGLE Normal -1856 -272 -3648 -1472
RECTANGLE Normal -2096 -992 -2976 -1408
RECTANGLE Normal -1856 1024 -3648 -176
RECTANGLE Normal -2096 240 -2960 -112
RECTANGLE Normal -3888 1024 -5840 -176
RECTANGLE Normal 608 400 -928 -768
